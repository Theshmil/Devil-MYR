<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Level Devil Clone with Restart</title>
<style>
  body {
    margin: 0; 
    background: #111; 
    font-family: monospace;
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    height: 100vh;
  }
  canvas {
    background: #222; 
    display: block;
  }
  .controls {
    display: flex; 
    gap: 20px;
    margin-top: 10px;
  }
  .btn {
    width: 80px; 
    height: 80px; 
    background: #444; 
    color: #0f0; 
    border: none; 
    font-size: 32px; 
    border-radius: 10px;
    user-select: none;
  }
  #restartBtn {
    display: none;
    margin-top: 20px;
    padding: 15px 30px;
    font-size: 24px;
    background: #444;
    color: #0f0;
    border: none;
    border-radius: 10px;
  }
</style>
</head>
<body>
<canvas id="game" width="400" height="200"></canvas>
<div class="controls">
  <button class="btn" id="left">◀️</button>
  <button class="btn" id="jump">⬆️</button>
  <button class="btn" id="right">▶️</button>
</div>
<button id="restartBtn">Restart</button>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const restartBtn = document.getElementById("restartBtn");

let player, obstacles, gravity, ground, gameOver;

function initGame() {
  player = { x: 20, y: 160, w: 10, h: 10, dx: 0, dy: 0, jumping: false };
  gravity = 0.8;
  ground = 170;
  gameOver = false;

  obstacles = [
    { x: 100, y: ground, w: 20, h: 10 },
    { x: 200, y: ground-20, w: 20, h: 30 },
    { x: 300, y: ground, w: 20, h: 10 }
  ];
  restartBtn.style.display = "none";
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#555";
  ctx.fillRect(0, ground, canvas.width, canvas.height-ground);
  
  ctx.fillStyle = "#0f0";
  ctx.fillRect(player.x, player.y, player.w, player.h);
  
  ctx.fillStyle = "#f00";
  for (let obs of obstacles) {
    ctx.fillRect(obs.x, obs.y - obs.h, obs.w, obs.h);
  }
  
  if (gameOver) {
    ctx.fillStyle = "white";
    ctx.font = "30px monospace";
    ctx.fillText("Game Over", canvas.width/2 - 80, canvas.height/2);
  }
}

function collideRect(r1, r2) {
  return (
    r1.x < r2.x + r2.w &&
    r1.x + r1.w > r2.x &&
    r1.y < r2.y &&
    r1.y + r1.h > r2.y - r2.h
  );
}

function update() {
  if (gameOver) return;

  player.dy += gravity;
  player.y += player.dy;
  player.x += player.dx;

  if (player.y + player.h > ground) {
    player.y = ground - player.h;
    player.dy = 0;
    player.jumping = false;
  }

  for (let obs of obstacles) {
    if (collideRect(player, obs)) {
      gameOver = true;
      restartBtn.style.display = "block";
    }
  }

  if (player.x < 0) player.x = 0;
  if (player.x + player.w > canvas.width) player.x = canvas.width - player.w;
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

document.getElementById("left").addEventListener("touchstart", () => { if (!gameOver) player.dx = -2; });
document.getElementById("left").addEventListener("touchend", () => { if (!gameOver) player.dx = 0; });

document.getElementById("right").addEventListener("touchstart", () => { if (!gameOver) player.dx = 2; });
document.getElementById("right").addEventListener("touchend", () => { if (!gameOver) player.dx = 0; });

document.getElementById("jump").addEventListener("touchstart", () => {
  if (!player.jumping && !gameOver) {
    player.dy = -10;
    player.jumping = true;
  }
});

restartBtn.addEventListener("click", () => {
  initGame();
});

initGame();
loop();
</script>
</body>
</html>