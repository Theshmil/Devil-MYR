<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mini Devil Game</title>
<style>
  body { margin: 0; background: #111; color: #fff; text-align: center; }
  canvas { background: #222; display: block; margin: 0 auto; }
  #controls { margin-top: 10px; }
  .btn {
    font-size: 30px;
    padding: 20px;
    margin: 5px;
    background: #444;
    color: orange;
    border: none;
    border-radius: 10px;
    width: 70px;
    height: 70px;
  }
  #restartBtn {
    font-size: 24px;
    color: lime;
    background: #444;
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    display: none;
    margin-top: 10px;
  }
</style>
</head>
<body>
<canvas id="game" width="400" height="200"></canvas>
<div id="controls">
  <button class="btn" ontouchstart="left=true" ontouchend="left=false">◀️</button>
  <button class="btn" ontouchstart="jumpAction()">⬆️</button>
  <button class="btn" ontouchstart="right=true" ontouchend="right=false">▶️</button>
</div>
<button id="restartBtn" onclick="restart()">Restart</button>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let player, obstacles, door;
let gravity = 0.5;
let gameOver = false;
let youWin = false;

let left = false, right = false;
let ground = canvas.height - 20;

function init() {
  player = { x: 10, y: ground-20, w:10, h:10, dx:0, dy:0, jumping:false };
  obstacles = [
    {x: 100, y: ground-20, w:10, h:20},
    {x: 180, y: ground-10, w:10, h:10},
    {x: 250, y: ground-10, w:10, h:10},
  ];
  door = {x: 350, y: ground-20, w:10, h:20};
  gameOver = false;
  youWin = false;
  document.getElementById('restartBtn').style.display = 'none';
}

function jumpAction() {
  if (!player.jumping) {
    player.dy = -7;
    player.jumping = true;
  }
}

function collideRect(a,b) {
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}

function update() {
  if (gameOver || youWin) return;

  player.dy += gravity;
  player.y += player.dy;

  if (left) player.dx = -2;
  else if (right) player.dx = 2;
  else player.dx = 0;

  player.x += player.dx;

  if (player.y + player.h > ground) {
    player.y = ground - player.h;
    player.dy = 0;
    player.jumping = false;
  }

  for (let obs of obstacles) {
    if (collideRect(player, obs) && player.y + player.h - 2 <= obs.y + obs.h) {
      gameOver = true;
      document.getElementById('restartBtn').style.display = 'block';
    }
  }

  if (collideRect(player, door)) {
    youWin = true;
    document.getElementById('restartBtn').style.display = 'block';
  }

  if (player.x < 0) player.x = 0;
  if (player.x+player.w > canvas.width) player.x = canvas.width - player.w;
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#555";
  ctx.fillRect(0,ground,canvas.width,20);

  ctx.fillStyle="green";
  ctx.fillRect(player.x,player.y,player.w,player.h);

  ctx.fillStyle="red";
  for (let obs of obstacles)
    ctx.fillRect(obs.x,obs.y,obs.w,obs.h);

  ctx.fillStyle="blue";
  ctx.fillRect(door.x,door.y,door.w,door.h);

  if (gameOver) {
    ctx.fillStyle="white";
    ctx.font="20px monospace";
    ctx.fillText("Game Over", canvas.width/2-50, canvas.height/2);
  }

  if (youWin) {
    ctx.fillStyle="white";
    ctx.font="20px monospace";
    ctx.fillText("YOU WIN!", canvas.width/2-50, canvas.height/2);
  }
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

function restart() {
  init();
}

init();
loop();
</script>
</body>
</html>