<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Level Devil Clone</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
  body { margin: 0; overflow: hidden; background: #222; touch-action: manipulation; }
  canvas { display: block; margin: auto; background: #444; }
  #controls {
    position: fixed;
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 20px;
    z-index: 10;
  }
  button {
    width: 100px;
    height: 100px;
    font-size: 30px;
    border-radius: 50%;
    border: none;
    background: #666;
    color: white;
  }
</style>
</head>
<body>
<canvas id="game" width="800" height="400"></canvas>
<div id="controls">
  <button id="left">◀️</button>
  <button id="jump">⬆️</button>
  <button id="right">▶️</button>
</div>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let player = { x: 100, y: 300, w: 40, h: 40, dy: 0, onGround: false };
let gravity = 1;
let jumpStrength = -20;
let speed = 8;
let isLeft = false, isRight = false;
let gameOver = false;
let youWin = false;

let spikes = [{ x: 300, y: 360, w: 40, h: 40 }, { x: 500, y: 360, w: 40, h: 40 }];
let door = { x: 700, y: 320, w: 40, h: 80 };
let enemies = [{ x: 400, y: 360, w: 40, h: 40, dir: 1 }];
let camera = { x: 0, y: 0, width: canvas.width, height: canvas.height };

document.getElementById('left').addEventListener('touchstart', ()=>{ isLeft=true; });
document.getElementById('left').addEventListener('touchend', ()=>{ isLeft=false; });
document.getElementById('right').addEventListener('touchstart', ()=>{ isRight=true; });
document.getElementById('right').addEventListener('touchend', ()=>{ isRight=false; });
document.getElementById('jump').addEventListener('touchstart', jump);

function jump() {
  if (player.onGround && !gameOver && !youWin) {
    player.dy = jumpStrength;
    player.onGround = false;
  }
}

function resetGame() {
  player.x = 100;
  player.y = 300;
  player.dy = 0;
  gameOver = false;
  youWin = false;
  camera.x = 0;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw the world
  ctx.save();
  ctx.translate(-camera.x, -camera.y); // Move the camera

  ctx.fillStyle="#888";
  ctx.fillRect(0, 360, 2000, 40); // Larger ground for scrolling

  ctx.fillStyle="red";
  spikes.forEach(s => ctx.fillRect(s.x, s.y, s.w, s.h));

  ctx.fillStyle="green";
  ctx.fillRect(door.x, door.y, door.w, door.h);

  ctx.fillStyle="purple";
  enemies.forEach(e => ctx.fillRect(e.x, e.y, e.w, e.h));

  ctx.fillStyle="yellow";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  if (gameOver) {
    ctx.fillStyle="white";
    ctx.font="50px sans-serif";
    ctx.fillText("Game Over", canvas.width / 2 - 140, canvas.height / 2);
    ctx.font="30px sans-serif";
    ctx.fillText("Tap jump to restart", canvas.width / 2 - 140, canvas.height / 2 + 40);
  }

  if (youWin) {
    ctx.fillStyle="white";
    ctx.font="50px sans-serif";
    ctx.fillText("You Win!", canvas.width / 2 - 100, canvas.height / 2);
  }

  ctx.restore();
}

function update() {
  if (!gameOver && !youWin) {
    // Move player
    if (isLeft) player.x -= speed;
    if (isRight) player.x += speed;

    player.dy += gravity;
    player.y += player.dy;

    // Check for ground collision
    if (player.y + player.h >= 360) {
      player.y = 360 - player.h;
      player.dy = 0;
      player.onGround = true;
    }

    // Check spikes
    spikes.forEach(s => {
      if (player.x < s.x + s.w && player.x + player.w > s.x &&
          player.y < s.y + s.h && player.y + player.h > s.y) {
        gameOver = true;
        isLeft = false;
        isRight = false;
      }
    });

    // Check enemies
    enemies.forEach(e => {
      e.x += e.dir * 4;
      if (e.x <= 300 || e.x + e.w >= 500) e.dir *= -1;
      if (player.x < e.x + e.w && player.x + player.w > e.x &&
          player.y < e.y + e.h && player.y + player.h > e.y) {
        gameOver = true;
        isLeft = false;
        isRight = false;
      }
    });

    // Check win condition
    if (player.x < door.x + door.w && player.x + player.w > door.x &&
        player.y < door.y + door.h && player.y + player.h > door.y) {
      youWin = true;
      isLeft = false;
      isRight = false;
    }

    // Camera follows the player
    camera.x = Math.max(0, player.x - canvas.width / 2); // Keep player centered horizontally
    camera.y = Math.max(0, Math.min(360 - canvas.height, player.y - canvas.height / 2)); // Vertical movement limit
  }
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

document.getElementById('jump').addEventListener('touchend', () => {
  if (gameOver) resetGame();
});

loop();
</script>
</body>
</html>